## ìƒì†

- ë¶€ëª¨ í´ë˜ìŠ¤ì™€ ìì‹ í´ë˜ìŠ¤ë¥¼ ì—°ê²°í•´ì„œ ë¶€ëª¨ í´ë˜ìŠ¤ì˜ ì½”ë“œë¥¼ ì¬ì‚¬ìš©
- ì˜ì¡´ì„±ì´ ì»´íŒŒì¼ íƒ€ì„ì— í•´ê²°
- is - a ê´€ê³„
- ë¶€ëª¨ í´ë˜ìŠ¤ì˜ ë‚´ë¶€ êµ¬í˜„ì— ì˜ì¡´
- ì •ì ì¸ ê´€ê³„

## í•©ì„±

- ì „ì²´ë¥¼ í‘œí˜„í•˜ëŠ” ê°ì²´ê°€ ë¶€ë¶„ì„ í‘œí˜„í•˜ëŠ” ê°ì²´ë¥¼ í¬í•¨í•´ì„œ ë¶€ë¶„ ê°ì²´ì˜ ì½”ë“œë¥¼ ì¬ì‚¬ìš©
- ì˜ì¡´ì„±ì´ ëŸ°íƒ€ì„ì— í•´ê²°
- has - a ê´€ê³„
- í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´
- ë™ì ì¸ ê´€ê³„

: ìƒì† ëŒ€ì‹  í•©ì„±ì„ ì‚¬ìš©í•˜ë©´ ë³€ê²½í•˜ê¸° ì‰½ê³  ìœ ì—°í•œ ì„¤ê³„ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤!

# ìƒì†ì„ ì‚¬ìš©í–ˆì„ ë•Œì˜ ë¬¸ì œì 

## 1. ë¶ˆí•„ìš”í•œ ì¸í„°í˜ì´ìŠ¤ ìƒì† ë¬¸ì œ

**<java.util.Stack>**

**ë¬¸ì œ** : Stackì˜ í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤ì— ë¶ˆí•„ìš”í•œ Vectorì˜ ì˜¤í¼ë ˆì´ì…˜ë“¤ì´ ìƒì†

**í•´ê²°** : Stack í´ë˜ìŠ¤ì—ì„œ Vector ìƒì†ê´€ê³„ë¥¼ ì œê±°í•˜ê³ , Vector ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¥¼ Stack í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¡œ ì„ ì–¸. â†’ í•©ì„± ê´€ê³„ë¡œ ë³€ê²½
```JAVA
public class Stack<E> {
  private Vector<E> elements = new Vector<>();

  public E push (E item) {
    elements.addElement(item);
    return item;
  }

  public E pop() {
    if (elements.isEmpty()) {
      throw new EmptyStackException();
    }
    return elements.remove(elements.size() - 1);
  }
}
```

## 2. ë©”ì„œë“œ ì˜¤ë²„ë¼ì´ë”©ì˜ ì˜¤ì‘ìš© ë¬¸ì œ
**instrumentedhashset**
ë¬¸ì œ : ë‚´ë¶€ ë©”ì„œë“œ í˜¸ì¶œë¡œ ì¸í•´ ì˜ˆìƒì¹˜ ëª»í•œ ë™ì‘ ë°œìƒ (addCount ì´ì¤‘ ì¹´ìš´íŒ…)

í•´ê²° : HashSet ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë‚´ë¶€ì— í¬í•¨í•œ í›„, HashSet í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤ì—ì„œ ì œê³µí•˜ëŠ” ì˜¤í¼ë ˆì´ì…˜ ì‚¬ìš©. â†’ í•©ì„± ê´€ê³„ë¡œ ë³€ê²½

```JAVA
public class InstrumetedHashSet<E> implements Set<E> {
	private int addCount = 0;
	private Set<E> set;

	public InstrumentedHashSet(Set<E> set) {
		this.set = set;
	}

	@Override
	public boolean add(E e) {
		addCount++;
		return set.add(e);
	}

	@Override
	public boolean addAll(Collection<? extends E> c) {
		addCount += c.size();
		return set.addAll(c);
	}

	public int getAddCount() {
		return addCount;
	}

	@Override public boolean remove(Object o) { return set.remove(o); }
	@Override public void clear() { set.clear(); }
  // ë‚˜ë¨¸ì§€ ìƒëµ .......ã…ã…ã…
}
```

ğŸ¤“Â : HashSetì— ëŒ€í•œ êµ¬í˜„ ê²°í•©ë„ëŠ” ì œê±°í•˜ë©´ì„œ, Setì˜ ë‹¤ë¥¸ ë©”ì„œë“œë“¤ë„ ì“°ê³  ì‹¶ì–´~~~!

### í¬ì›Œë”© ë©”ì„œë“œ

ë™ì¼í•œ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ ì¶”ê°€ëœ ë©”ì„œë“œ!

ê¸°ì¡´ í´ë˜ìŠ¤ì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ê·¸ëŒ€ë¡œ ì™¸ë¶€ì— ì œê³µí•˜ë©´ì„œ, êµ¬í˜„ì— ëŒ€í•œ ê²°í•© ì—†ì´ ì¼ë¶€ ì‘ë™ ë°©ì‹ì„ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.

## 3. ë¶€ëª¨ í´ë˜ìŠ¤ì™€ ìì‹ í´ë˜ìŠ¤ì˜ ë™ì‹œ ìˆ˜ì • ë¬¸ì œ

**Playlist**

í•©ì„±ìœ¼ë¡œ ë³€ê²½í•´ë„ ê°€ìˆ˜ë³„ ë…¸ë˜ ëª©ë¡ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ Playlistì™€ PersonalPlaylistë¥¼ í•¨ê»˜ ìˆ˜ì •í•´ì•¼ í•˜ëŠ” ë¬¸ì œê°€ í•´ê²° X

**But,** ì—¬ì „íˆ ìƒì†ë³´ë‹¤ëŠ” í•©ì„±ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. Playlistì˜ ë‚´ë¶€ êµ¬í˜„ì´ ë³€ê²½ë˜ì–´ë„ PersonalPlaylist ë‚´ë¶€ë¡œ ìº¡ìŠí™”í•  ìˆ˜ ìˆê¸° ë•Œë¬¸!

### ëª½í‚¤ íŒ¨ì¹˜ ğŸ’ğŸ’ğŸ’

: í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ í™˜ê²½ì—ë§Œ ì˜í–¥ì„ ë¯¸ì¹˜ë„ë¡ ì§€ì—­ì ìœ¼ë¡œ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ê±°ë‚˜ í™•ì¥í•˜ëŠ” ê²ƒ

# ìƒì†ìœ¼ë¡œ ì¸í•œ ì¡°í•©ì˜ í­ë°œì ì¸ ì¦ê°€

**ìƒì†ìœ¼ë¡œ ì¸í•´ ê²°í•©ë„ê°€ ë†’ì•„ì§€ë©´?**

- í•˜ë‚˜ì˜ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê±°ë‚˜ ìˆ˜ì •í•˜ê¸° ìœ„í•´ ë¶ˆí•„ìš”í•˜ê²Œ ë§ì€ ìˆ˜ì˜ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ìˆ˜ì •í•´ì•¼ í•œë‹¤.
- ë‹¨ì¼ ìƒì†ë§Œ ì§€ì›í•˜ëŠ” ì–¸ì–´ì—ì„œëŠ” ìƒì†ìœ¼ë¡œ ì¸í•´ ì˜¤íˆë ¤ ì¤‘ë³µ ì½”ë“œì˜ ì–‘ì´ ëŠ˜ì–´ë‚  ìˆ˜ ìˆë‹¤.

# ğŸ“í•¸ë“œí° ê³¼ê¸ˆ ì‹œìŠ¤í…œğŸ“

- ê¸°ë³¸ ì •ì±… (í•œë‹¬ í†µí™”ëŸ‰ì„ ê¸°ì¤€ìœ¼ë¡œ ìš”ê¸ˆ ê³„ì‚°)
    - ì¼ë°˜ ìš”ê¸ˆì œ
    - ì‹¬ì•¼ í• ì¸ ìš”ê¸ˆì œ
- ë¶€ê°€ ì •ì±…
    - ì„¸ê¸ˆ ì •ì±…
    - ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…

**<ë¶€ê°€ ì •ì±…ì˜ íŠ¹ì„±>**

1. ê¸°ë³¸ ì •ì±…ì˜ ê³„ì‚° ê²°ê³¼ì— ì ìš©ëœë‹¤
2. ì„ íƒì ìœ¼ë¡œ ì ìš©í•  ìˆ˜ ìˆë‹¤
3. ì¡°í•© ê°€ëŠ¥í•˜ë‹¤
4. ë¶€ê°€ ì •ì±…ì€ ì„ì˜ì˜ ìˆœì„œë¡œ ì ìš© ê°€ëŠ¥í•˜ë‹¤

![[Pasted image 20240817135827.png]]

### ìƒì†ì„ ì´ìš©í•œ êµ¬í˜„

```java
public abstract class Phone {
  private List<Call> calls = new ArrayList<>();

  public Money calculateFee() {
    Money result = Money.ZERO;
    for (Call call : calls) {
      result = result.plus(calculateCallFee(call));
    }
    return result;
  }
  abstract protected Money calculateCallFee(Call call);
}

public class RegularPhone extends Phone {
  private Money amount;
  private Duration seconds;

  public RegularPhone(Money amount, Duration seconds) {
    this.amount = amount;
    this.seconds = seconds;
  }

  @Override
  protected Money calculateCallFee(Call call) {
    return amount.times(call.getDuration().getSeconds() / seconds.getSeconds());
  }
}

public class NightlyDiscountPhone extends Phone {
  private static final int LATE_NIGHT_HOUR = 22;

  private Money nightlyAmount;
  private Money regularAmount;
  private Duration seconds;

  public NightlyDiscountPhone(Money nightlyAmount, Money regularAmount, Duration seconds) {
    this.nightlyAmount = nightlyAmount;
    this.regularAmount = regularAmount;
    this.seconds = seconds;
  }

  @Override
  protected Money calculateCallFee(Call call) {
    if (call.getFrom().getHour() >= LATE_NIGHT_HOUR) {
      return nightlyAmount.times(call.getDuration().getSeconds() / seconds.getSeconds());
    }

    return regularAmount.times(call.getDuration().getSeconds() / seconds.getSeconds());
  } 
}
```

## 1. ì¼ë°˜ ìš”ê¸ˆì œì— ì„¸ê¸ˆ ì •ì±… ì¡°í•©í•˜ê¸°

: RegularPhoneì„ ìƒì†ë°›ì€ TaxableRegularPhone ì¶”ê°€í•˜ê¸°!

```java
public class TaxableRegularPhone extends RegularPhone {
  private double taxRate;

  public TaxableRegularPhone(Money amount, Duration seconds, double taxRate) {
    super(amount, seconds);
    this.taxRate = taxRate;
  }

  @Override
  public Money calculateFee() {
    Money fee = super.calculateFee();
    return fee.plus(fee.times(taxRate));
  }
}
```

â†’ super í˜¸ì¶œì„ ì‚¬ìš©í•˜ë©´ ì‰½ê²Œ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆì§€ë§Œ, ìì‹ê³¼ ë¶€ëª¨ ê°„ì˜ ê²°í•©ë„ê°€ ë†’ì•„ì§!

ê²°í•©ë„ ë‚®ì¶”ëŠ” ë²• : ë¶€ëª¨ í´ë˜ìŠ¤ì— ì¶”ìƒ ë©”ì„œë“œë¥¼ ì¤˜ì„œ ìì‹ í´ë˜ìŠ¤ê°€ ë¶€ëª¨ê°€ ì•„ë‹Œ ì¶”ìƒí™”ì— ì˜ì¡´í•˜ë„ë¡ í•˜ê¸° (`afterCalculated`ë¥¼ ì¶”ê°€)

```java
public abstract class Phone {
  private List<Call> calls = new ArrayList<>();

  public Money calculateFee() {
    Money result = Money.ZERO;

    for (Call call : calls) {
      result = result.plus(calculateCallFee(call));
    }

    return afterCalculated(result);
  }

  protected abstract Money calculateCallFee(Call call);
  protected abstract Money afterCalculated(Money fee);
}
```

ì•„ë˜ ì½”ë“œì™€ ê°™ì´ ëª¨ë“  ìì‹ í´ë˜ìŠ¤ë“¤ì´ ì¶”ìƒ ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”© í•´ì¤˜ì•¼í•˜ëŠ” ê·€ì°®ìŒì´ ë°œìƒí•¨

```java
class RegularPhone extends Phone {
  ...
  protected afterCalculated(fee: number): number {
    return fee;
  }
}

class NightlyDiscountPhone extends Phone {
  ...
  protected afterCalculated(fee: number): number {
    return fee;
  }
}
```

ê·€ì°®ìœ¼ë©´ ?!

## í›… ë©”ì„œë“œ ğŸ¤›
: ê¸°ë³¸ êµ¬í˜„ì€ ì œê³µí•˜ë©´ì„œ, ìì‹ í´ë˜ìŠ¤ì—ì„œ í•„ìš”ì— ë”°ë¼ ì˜¤ë²„ë¼ì´ë”©í•˜ì—¬ ë™ì‘ì„ ë³€ê²½í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ë©”ì„œë“œ

ê¸°ë³¸ ë™ì‘ì´ êµ¬í˜„ë˜ì–´ ìˆì–´ì„œ ìì‹ í´ë˜ìŠ¤ê°€ ì˜¤ë²„ë¼ì´ë”©í•˜ì§€ ì•Šì•„ë„ ë™ì‘.

```java
public abstract class Phone {  
  ...
  protected Money afterCalculated(Money fee) {
    return fee;
  }
  protected abstract Money afterCalculated(Money fee);
 }
```

**í›… ë©”ì„œë“œì— ë§ê²Œ ë‚˜ë¨¸ì§€ ì½”ë“œë¥¼ ìˆ˜ì •í•´ë³´ì.**

```java
public class TaxableRegularPhone extends RegularPhone {
  private double taxRate;

  public TaxableRegularPhone(Money amount, Duration seconds, double taxRate) {
    super(amount, seconds);
    this.taxRate = taxRate;
  }

  @Override
  public Money afterCalculated(Money fee) {
    return fee.plus(fee.times(taxRate));
  }
}

public class TaxableNightlyDiscountPhone extends RegularPhone {
  private double taxRate;

  public TaxableNightlyDiscountPhone(Money nightlyAmount, Money regularAmount, Duration seconds, double taxRate) {
    super(nightlyAmount, regularAmount, seconds);
    this.taxRate = taxRate;
  }

  @Override
  public Money afterCalculated(Money fee) {
    return fee.plus(fee.times(taxRate));
  }
}
```

ì¡°í•©ì— ë”°ë¼ ì›í•˜ëŠ” ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ë©´ ëœë‹¤!
 ![[3.png]]

 
## 2. ê¸°ë³¸ ì •ì±…ì— ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±… ì¡°í•©í•˜ê¸°

ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±… : ë§¤ë‹¬ ì²­êµ¬ë˜ëŠ” ìš”ê¸ˆì—ì„œ ê³ ì •ëœ ìš”ê¸ˆì„ ì°¨ê°í•˜ëŠ” ë¶€ê°€ ì •ì±…

<ì¼ë°˜ ìš”ê¸ˆì œ + ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…>

```java
public class RateDiscountableRegularPhone extends RegularPhone {
  private Money discountAmount;

  public RateDiscountableRegularPhone(Money amount, Duration seconds, Money discountAmount) {
      super(amount, seconds);
      this.discountAmount = discountAmount;
  }

  @Override
  protected Money afterCalculated(Money fee) {
      return fee.minus(discountAmount);
  }
}
```

<ì‹¬ì•¼ í• ì¸ ìš”ê¸ˆì œ + ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…>

```java
public class RateDiscountableNightlyDiscountPhone extends NightlyDiscountPhone {
    private Money discountAmount;

    public RateDiscountableNightlyDiscountPhone(Money nightlyAmount,
                                                Money regularAmount, Duration seconds, Money discountAmount) {
        super(nightlyAmount, regularAmount, seconds);
        this.discountAmount = discountAmount;
    }

    @Override
    protected Money afterCalculated(Money fee) {
        return fee.minus(discountAmount);
    }
}
```

â†’ ì¤‘ë³µ ì½”ë“œì˜ ë«ì— ê±¸ë¦¼!!!

ëª¨ë“  ê°€ëŠ¥í•œ ì¡°í•©ë³„ë¡œ ìì‹ í´ë˜ìŠ¤ë¥¼ í•˜ë‚˜ì”© ì¶”ê°€í•´ì•¼ í•¨.

ex.) ì¼ë°˜ ìš”ê¸ˆì œ ê³„ì‚° ê²°ê³¼ì— ì„¸ê¸ˆ ì •ì±…ì„ ì¡°í•©í•œ í›„, ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ ì¶”ê°€í•˜ê³  ì‹¶ë‹¤ë©´? TaxableRegularPhoneì„ ìƒì†ë°›ëŠ” ìƒˆë¡œìš´ ìì‹ í´ë˜ìŠ¤ì¸ TaxableAndRateDiscountableRegularPhoneì„ ì¶”ê°€í•´ì•¼ í•¨.

![[4.png]]

**!!í´ë˜ìŠ¤ í­ë°œ!!ğŸ’¥Â ğŸ¤¯ ğŸ§¨**

: ìƒì†ì˜ ë‚¨ìš©ìœ¼ë¡œ í•˜ë‚˜ì˜ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê¸° ìœ„í•´ í•„ìš” ì´ìƒìœ¼ë¡œ ë§ì€ ìˆ˜ì˜ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•´ì•¼ í•˜ëŠ” ê²½ìš°

# í•©ì„± ê´€ê³„ë¡œ ë³€ê²½í•˜ê¸°

ìƒì† ê´€ê³„ëŠ” ì»´íŒŒì¼ íƒ€ì„ì— ê²°ì •ë˜ê³  ê³ ì •.

í•©ì„± ê´€ê³„ëŠ” ëŸ°íƒ€ì„ì— ê°ì²´ì˜ ê´€ê³„ ë³€ê²½ ê°€ëŠ¥

ìƒì† : ì¡°í•©ì˜ ê²°ê³¼ë¥¼ ê°œë³„ í´ë˜ìŠ¤ ì•ˆìœ¼ë¡œ ë°€ì–´ ë„£ëŠ” ë°©ë²•

í•©ì„± : ì¡°í•©ì„ êµ¬ì„±í•˜ëŠ” ìš”ì†Œë“¤ì„ ê°œë³„ í´ë˜ìŠ¤ë¡œ êµ¬í˜„í•œ í›„ ì‹¤í–‰ ì‹œì ì— ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¡°ë¦½í•˜ëŠ” ë°©ë²•

**í•©ì„±ìœ¼ë¡œ ë°”ê¿”ë³´ì!**

1. ê¸°ë³¸ ì •ì±… í•©ì„±í•˜ê¸°
2. ë¶€ê°€ ì •ì±… ì ìš©í•˜ê¸°
3. ê¸°ë³¸ ì •ì±…ê³¼ ë¶€ê°€ ì •ì±… í•©ì„±í•˜ê¸°
4. ìƒˆë¡œìš´ ì •ì±… ì¶”ê°€í•˜ê¸°

## 1. ê¸°ë³¸ ì •ì±… í•©ì„±í•˜ê¸°

**`RatePolicy`**

- ê¸°ë³¸ ì •ì±…
    - ì¼ë°˜ ìš”ê¸ˆì œ
    - ì‹¬ì•¼ í• ì¸ ìš”ê¸ˆì œ
- ë¶€ê°€ ì •ì±…
    - ì„¸ê¸ˆ ì •ì±…
    - ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…

```java
public interface RatePolicy {
  Money calculateFee(Phone phone);
}
```

**ê¸°ë³¸ ì •ì±… BasicRatePolicy**

â†’ ì¼ë°˜ ìš”ê¸ˆì œì™€ ì‹¬ì•¼ í• ì¸ ìš”ê¸ˆì œì˜ ì¤‘ë³µ ì½”ë“œ

```java
public abstract class BasicRatePolicy implements RatePolicy {
  @Override
  public Money calculateFee(Phone phone) {
      Money result = Money.ZERO;
      
      for(Call call : phone.getCalls()) {
          result.plus(calculateCallFee(call));
      }
      return result;
  }
  protected abstract Money calculateCallFee(Call call);
}
```

**ì¼ë°˜ ìš”ê¸ˆì œ RegularPolicy**ì™€ **ì‹¬ì•¼ í• ì¸ ìš”ê¸ˆì œ NightlyDiscountPolicy**

```java
public class RegularPolicy extends BasicRatePolicy {
	....
  @Override
  protected Money calculateCallFee(Call call) {
      return amount.times(call.getDuration().getSeconds() / seconds.getSeconds());
  }
}
-------------
public class NightlyDiscountPolicy extends BasicRatePolicy {
	...
	@Override
  protected Money calculateCallFee(Call call) {
      if (call.getFrom().getHour() >= LATE_NIGHT_HOUR) {
          return nightlyAmount.times(call.getDuration().getSeconds() / seconds.getSeconds());
      }

      return regularAmount.times(call.getDuration().getSeconds() / seconds.getSeconds());
  }
}
```

`Phone` ìˆ˜ì •

```java
public class Phone {
  private RatePolicy ratePolicy;
  private List<Call> calls = new ArrayList<>();

  public Phone(RatePolicy ratePolicy) {
      this.ratePolicy = ratePolicy;
  }

  public List<Call> getCalls() {
      return Collections.unmodifiableList(calls);
  }

  public Money calculateFee() {
      return ratePolicy.calculateFee(this);
  }
}
```

## 2. ë¶€ê°€ ì •ì±… ì ìš©í•˜ê¸°

![[6.png]]

![[7.png]]

![[89.png]]


- ë¶€ê°€ ì •ì±…ì€ ê¸°ë³¸ ì •ì±…ì´ë‚˜ ë‹¤ë¥¸ ë¶€ê°€ ì •ì±…ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.
- Phoneì˜ ì…ì¥ì—ì„œëŠ” ìì‹ ì´ ê¸°ë³¸ ì •ì±…ì˜ ì¸ìŠ¤í„´ìŠ¤ì—ê²Œ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•˜ê³  ìˆëŠ”ì§€, ë¶€ê°€ ì •ì±…ì˜ ì¸ìŠ¤í„´ìŠ¤ì—ê²Œ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•˜ê³  ìˆëŠ”ì§€ ëª°ë¼ì•¼ í•œë‹¤.

**ë¶€ê°€ì •ì±… AdditionalRatePolicy**

```java
public abstract class AdditionalRatePolicy implements RatePolicy {
  private RatePolicy next;

  public AdditionalRatePolicy(RatePolicy next) {
      this.next = next;
  }

  @Override
  public Money calculateFee(Phone phone) {
      Money fee = next.calculateFee(phone);
      return afterCalculated(fee) ;
  }

  abstract protected Money afterCalculated(Money fee);
}
```

- Phoneì˜ ì…ì¥ì—ì„œëŠ” AdditionalRatePolicyë„ RatePolicyì˜ ì—­í• ì„ ìˆ˜í–‰í•˜ê¸° ë•Œë¬¸ì— RatePolicy ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„
- ë˜ ë‹¤ë¥¸ ìš”ê¸ˆ ì •ì±…ê³¼ ì¡°í•©ë  ìˆ˜ ìˆë„ë¡ RatePolicy íƒ€ì…ì˜ `next`ë¼ëŠ” ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¥¼ ë‚´ë¶€ì— í¬í•¨

```java
public class TaxablePolicy extends AdditionalRatePolicy {
  private double taxRatio;

  public TaxablePolicy(double taxRatio, RatePolicy next) {
      super(next);
      this.taxRatio = taxRatio;
  }

  @Override
  protected Money afterCalculated(Money fee) {
      return fee.plus(fee.times(taxRatio));
  }
}
------------
public class RateDiscountablePolicy extends AdditionalRatePolicy {
  private Money discountAmount;

  public RateDiscountablePolicy(Money discountAmount, RatePolicy next) {
      super(next);
      this.discountAmount = discountAmount;
  }

  @Override
  protected Money afterCalculated(Money fee) {
      return fee.minus(discountAmount);
  }
}
```

![[Pasted image 20240817141918.png]]
## 3. ê¸°ë³¸ ì •ì±…ê³¼ ë¶€ê°€ ì •ì±… í•©ì„±í•˜ê¸°

```java
Phone phone = new Phone(
    new RateDiscountablePolicy(Money.wons(1000), 
        new TaxablePolicy(0.05, 
            new RegularPolicy(
                Money.wons(100),
                Duration.ofSeconds(60)
            )
        )
    )
);
```

## 4. ìƒˆë¡œìš´ ì •ì±… ì¶”ê°€í•˜ê¸°
![[image.png]]


: ìƒˆë¡œìš´ ê¸°ë³¸ ì •ì±…ì´ ì¶”ê°€ëœë‹¤ë©´ í´ë˜ìŠ¤ í•˜ë‚˜ë§Œ ìƒì„±í•´ì£¼ê¸°


![[image2.png]]
: ìƒˆë¡œìš´ ë¶€ê°€ ì •ì±…ì´ ì¶”ê°€ëœë‹¤ë©´ í´ë˜ìŠ¤ í•˜ë‚˜ë§Œ ìƒì„±í•´ì£¼ê¸° ~

â†’ ìš”êµ¬ ì‚¬í•­ì„ ë³€ê²½í•  ë•Œ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ë§Œ ìˆ˜ì •í•´ë„ ëœë‹¤. ë‹¨ì¼ ì±…ì„ ì›ì¹™ì„ ì¤€ìˆ˜í•˜ê²Œ ë˜ì—ˆë‹¤.

# ë¯¹ìŠ¤ì¸

: ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ì½”ë“œ ì¼ë¶€ë¥¼ í´ë˜ìŠ¤ ì•ˆì— ì„ì–´ ë„£ì–´ ì¬ì‚¬ìš©í•˜ëŠ” ê¸°ë²•

### ë¯¹ìŠ¤ì¸ì€ ìƒì†ê³¼ ë‹¤ë¥´ë‹¤

ìƒì†ì˜ ì§„ì •í•œ ëª©ì ì€ ìì‹ í´ë˜ìŠ¤ë¥¼ ë¶€ëª¨ í´ë˜ìŠ¤ì™€ ë™ì¼í•œ ê°œë…ì ì¸ ë²”ì£¼ë¡œ ë¬¶ì–´ is-a ê´€ê³„ë¥¼ ë§Œë“¤ê¸° ìœ„í•œ ê²ƒì´ë‹¤. ë°˜ë©´ ë¯¹ìŠ¤ì¸ì€ ë§ ê·¸ëŒ€ë¡œ ì½”ë“œë¥¼ ë‹¤ë¥¸ ì½”ë“œ ì•ˆì— ì„ì–´ ë„£ê¸° ìœ„í•œ ë°©ë²•ì´ë‹¤.


# Hands - on
```JAVA
public class STARBUCKS {
	public void makeCoffee() {
		System.out.println("ì»¤í”¼ ë§Œë“¤ê¸°");
	}
}

public class MilkCoffee extends STARBUCKS { //ìš°ìœ  ì¶”ê°€
	@Override
	public void makeCoffee() {
		super.make();
		System.out.println("ìš°ìœ  ì¶”ê°€");		
	}
}

public class JavaChipCoffee extends STARBUCKS { //ìë°” ì•„ë‹ˆê³  ìë°”ì¹©
	@Override
	public void makeCoffee() {
		super.make();
		System.out.println("ìë°”ì¹© ì¶”ê°€");
	}
}

public class WhippedCreamCoffee extends STARBUCKS { //íœ˜í•‘í¬ë¦¼ ì¶”ê°€
	@Override
	public void makeCoffee() {
		super.make();
		System.out.println("íœ˜í•‘í¬ë¦¼ ì¶”ê°€");
	}
}

public class MilkWhippedCreamCoffee extends STARBUCKS { //ìš°ìœ  ì¶”ê°€í•˜ê³  ê·¸ ìœ„ì— íœ˜í•‘í¬ë¦¼ ì¶”ê°€í•´ì£¼ì„¸ìš”!
	@Override
	public void makeCoffee() {
		super.make();
		System.out.println("ìš°ìœ  ì¶”ê°€");	
		System.out.println("íœ˜í•‘í¬ë¦¼ ì¶”ê°€");
	}
}
```

ë‚˜ëŠ” ìŠ¤íƒ€ë²…ìŠ¤ ì•Œë°”ìƒì´ë‹¤. ì£¼ë¬¸ì„ ì»¤ìŠ¤í…€í•˜ëŠ” ì‚¬ëŒë“¤ì´ ì›Œë‚™ ë§ì•„ì„œ ìƒì†ìœ¼ë¡œ ì½”ë“œë¥¼ êµ¬í˜„í–ˆë‹¤.
ê·¸ëŸ°ë° ê°‘ìê¸° ì£¼ë¬¸ì´ ë°€ë ¤ ë“¤ì–´ì™”ë‹¤.
ğŸ¥¸ ë§¨ ë°‘ì— ìë°”ì¹© ê¹”ì•„ì£¼ì‹œê³  ìš°ìœ  ë„£ì–´ì£¼ì‹œê³  íœ˜í•‘í¬ë¦¼ ì¶”ê°€í•´ì£¼ì‹  ë‹¤ìŒì— ê·¸ ìœ„ì— ì´ˆì½” ë“œë¦¬ì¦ ë¿Œë ¤ì£¼ì„¸ìš”!
ğŸƒ ìš°ìœ  ë„£ì–´ì£¼ì‹œê³  ë§ˆì§€ë§‰ì— íœ˜í•‘í¬ë¦¼ë§Œ ì¶”ê°€í•´ì£¼ì„¸ìš”
ğŸ‘½ íœ˜í•‘í¬ë¦¼ ìœ„ì— ìë°”ì¹© ë¿Œë ¤ì£¼ì„¸ìš©

ì´ ì»¤í”¼ë“¤ì„ ë§Œë“¤ê¸° ìœ„í•´ ì¶”ê°€í•´ì•¼ í•˜ëŠ” í´ë˜ìŠ¤ê°€ ë„ˆë¬´ ë§ì•„ì¡Œë‹¤!!

í•©ì„±ì„ ì´ìš©í•´ì„œ ë³€ê²½ê³¼ ì¶”ê°€ì— ì‰½ê²Œ ëŒ€ì‘í•  ìˆ˜ ìˆëŠ” ì½”ë“œë¡œ ë³€ê²½í•˜ë ¤ë©´ ì–´ë–»ê²Œ ë°”ê¿”ì•¼í• ê¹Œ ? 


ë©”ì¸ ì½”ë“œ ì˜ˆì‹œ
```JAVA
public class Main {
    public static void main(String[] args) {
        // ê¸°ë³¸ ì»¤í”¼ ì¤€ë¹„
        Coffee coffee = new Coffee();
        
        // ì¶”ê°€í•  ì¬ë£Œ ì¤€ë¹„
        Milk milk = new Milk();
        JavaChip javaChip = new JavaChip();
        WhippedCream whippedCream = new WhippedCream();
        ChocoDrizzle chocoDrizzle = new ChocoDrizzle();
        
        // 1. ìë°”ì¹©, ìš°ìœ , íœ˜í•‘í¬ë¦¼, ì´ˆì½” ë“œë¦¬ì¦ ì¶”ê°€
        CustomCoffee customCoffee1 = new CustomCoffee(coffee, milk, javaChip, whippedCream, chocoDrizzle);
        customCoffee1.make();
        
        // 2. ìš°ìœ ì™€ íœ˜í•‘í¬ë¦¼ë§Œ ì¶”ê°€
        CustomCoffee customCoffee2 = new CustomCoffee(coffee, milk, null, whippedCream, null);
        customCoffee2.make();
        
        // 3. íœ˜í•‘í¬ë¦¼ê³¼ ìë°”ì¹©ë§Œ ì¶”ê°€
        CustomCoffee customCoffee3 = new CustomCoffee(coffee, null, javaChip, whippedCream, null);
        customCoffee3.make();
}
```
